
import random          # 用于产生随机数
import time            # 用于延时
from selenium.webdriver.common.by import By      #导入By包进行元素定位
from selenium import webdriver
from selenium.webdriver.chrome.options import Options

def run():
    # 实例化一个启动参数对象
    chrome_options = Options()

    # 添加启动参数
    chrome_options.add_argument(
        'user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36"')  # 添加请求头
    chrome_options.add_argument('--disable-blink-features=AutomationControlled')

    # 防止被识别
    chrome_options.add_experimental_option('excludeSwitches', ['enable-automation'])  # 设置开发者模式启动

    chrome_options.add_experimental_option('useAutomationExtension', False)  # 关闭selenium对chrome driver的自动控制

    chrome_options.maximize_window()  # 网页最大化

    # chrome_options.add_argument('headless')    #设置浏览器以无界面方式运行

    browser = webdriver.Chrome(options=chrome_options)  # 设置驱动程序，启动浏览器  （实现以特定参数启动）
    browser.execute_cdp_cmd('Page.addScriptToEvaluateOnNewDocument',
                            {
                                'source': 'Object.defineProperty(navigator, "webdriver", {get: () => undefined})'})  # 用来执行Chrome开发这个工具命令

    browser.get('https://www.wjx.cn/vm/Y6luJx8.aspx# ')  # 获取问卷信息(此处填问卷链接)

    # 问题1的点击 （性别）
    randomId = random.randint(1, 2)  # 随机点击第一个选项或第二个选项

    # js实现方式
    js = "document.getElementById(\"q1_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）
    js = "document.getElementById(\"q1_" + str(randomId) + "\").click()"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）

    # 延时 太快会被检测是脚本
    time.sleep(1)

    # 问题2    （年级）
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题3    （专业）
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题4   （新媒体）
    randomId = random.randint(1, 4)  # 随机数选择（选多少个）

    for i in range(1, randomId + 1):  # 循环 实现多选效果
        randomId1 = random.randint(1, 5)  # 随机选择第1到第6个选项之一

        # 两种js实现方式
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").checked = true"
        browser.execute_script(js)
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").click()"
        browser.execute_script(js)
    # 延时
    time.sleep(1)

    # 问题5
    randomId = random.randint(1, 4)  # 随机数选择（选多少个）

    for i in range(1, randomId + 1):  # 循环 实现多选效果
        randomId1 = random.randint(1, 5)  # 随机选择第1到第6个选项之一

        # 两种js实现方式
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").checked = true"
        browser.execute_script(js)
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").click()"
        browser.execute_script(js)

    # 延时
    time.sleep(1)

    # 问题6
    randomId = random.randint(1, 4)  # 随机数选择（选多少个）

    for i in range(1, randomId + 1):  # 循环 实现多选效果
        randomId1 = random.randint(1, 5)  # 随机选择第1到第6个选项之一

        # 两种js实现方式
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").checked = true"
        browser.execute_script(js)
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").click()"
        browser.execute_script(js)

    # 延时
    time.sleep(1)

    # 问题7
    randomId = random.randint(1, 4)  # 随机数选择（选多少个）

    for i in range(1, randomId + 1):  # 循环 实现多选效果
        randomId1 = random.randint(1, 5)  # 随机选择第1到第6个选项之一

        # 两种js实现方式
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").checked = true"
        browser.execute_script(js)
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").click()"
        browser.execute_script(js)

    # 延时
    time.sleep(1)

    # 问题8
    randomId = random.randint(1, 4)  # 随机数选择（选多少个）

    for i in range(1, randomId + 1):  # 循环 实现多选效果
        randomId1 = random.randint(1, 5)  # 随机选择第1到第6个选项之一

        # 两种js实现方式
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").checked = true"
        browser.execute_script(js)
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").click()"
        browser.execute_script(js)

    # 延时
    time.sleep(1)

    # 问题9
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题10
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题11
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题12
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题13
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题14
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题15
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题16
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题17
    randomId = random.randint(1, 2)  # 随机点击第一个选项或第二个选项

    # js实现方式
    js = "document.getElementById(\"q1_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）
    js = "document.getElementById(\"q1_" + str(randomId) + "\").click()"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）

    # 延时 太快会被检测是脚本
    time.sleep(1)

    # 问题18
    randomId = random.randint(1, 2)  # 随机点击第一个选项或第二个选项

    # js实现方式
    js = "document.getElementById(\"q1_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）
    js = "document.getElementById(\"q1_" + str(randomId) + "\").click()"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）

    # 延时 太快会被检测是脚本
    time.sleep(1)

    # 问题19
    randomId = random.randint(1, 2)  # 随机点击第一个选项或第二个选项

    # js实现方式
    js = "document.getElementById(\"q1_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）
    js = "document.getElementById(\"q1_" + str(randomId) + "\").click()"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）

    # 延时 太快会被检测是脚本
    time.sleep(1)

    # 问题20
    randomId = random.randint(1, 2)  # 随机点击第一个选项或第二个选项

    # js实现方式
    js = "document.getElementById(\"q1_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）
    js = "document.getElementById(\"q1_" + str(randomId) + "\").click()"
    browser.execute_script(js)  # 使用js实现点击的效果（调用js方法，同时执行javascript脚本）

    # 延时 太快会被检测是脚本
    time.sleep(1)

    # 问题21
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题22
    randomId = random.randint(1, 4)  # 随机数选择（选多少个）

    for i in range(1, randomId + 1):  # 循环 实现多选效果
        randomId1 = random.randint(1, 5)  # 随机选择第1到第6个选项之一

        # 两种js实现方式
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").checked = true"
        browser.execute_script(js)
        js = "document.getElementById(\"q5_" + str(randomId1) + "\").click()"
        browser.execute_script(js)

    # 延时
    time.sleep(1)

    # 问题23
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题24
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题25
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题26
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题27
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题28
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 问题29
    randomId = random.randint(1, 5)  # 随机数，5个多选框 随机点击
    # js实现方式
    js = "document.getElementById(\"q2_" + str(randomId) + "\").checked = true"
    browser.execute_script(js)
    js = "document.getElementById(\"q2_" + str(randomId) + "\").click()"  # 拼接字符串的方式 js找到对应id 点击按钮
    browser.execute_script(js)
    # 延时
    time.sleep(0.1)

    # 点击提交
    submit = browser.find_element_by_xpath("//*[@id='ctlNext']")  # 网页源代码的xpath
    submit.click()  # 点击

    # 延时 太快会被检测是脚本
    time.sleep(0.5)

    # 模拟点击智能验证按钮
    # 先点确认
    browser.find_element(By.XPATH, "//button[text()='确认']").click()
    time.sleep(1)
    # 再点智能验证提示框，进行智能验证
    browser.find_element_by_xpath("//div[@id='captcha']").click()

if __name__ == "__main__":
    #批量提交问卷
    for i in range(10):          #运行一次提交10份问卷
         run()
         time.sleep(5)  # 避免提交过快 会出现验证

